<!DOCTYPE html>
<html>
<head>
    <title>AI Battle Arena</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');

        body {
            font-family: 'Orbitron', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #D35400;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .top-bar {
            background-color: #000;
            color: #ffd700;
            padding: 20px;
            text-align: center;
            width: 100%;
            font-size: 28px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .top-bar h1 {
            margin: 0;
        }

        .top-bar img {
            max-width: 60%;
            height: auto;
            position: center;
            top: 10px;
            left: 50%;
            transform: translateX(-0%);
        }

        .main-section {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #333;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            width: 90%;
            border-radius: 10px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #ccc #f0f0f0;
        }

        .bot-response {
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            box-sizing: border-box;
            font-size: 16px;
            line-height: 1.8;
            animation: fadeIn 1s;
            color: #333;
            font-family: Arial, sans-serif;
        }

        .bot1-response {
            background-color: #ffddc1;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .bot2-response {
            background-color: #c1ffd7;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #question {
            padding: 15px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 10px;
            width: 70%;
            box-sizing: border-box;
            font-size: 18px;
            color: #333;
            background-color: #fff;
        }

        button {
            padding: 15px;
            background-color: #444;
            color: #ffd700;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }

        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #f0f0f0;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #ccc;
            border-radius: 20px;
            border: 3px solid #f0f0f0;
        }
    </style>
</head>
<body>

<div class="top-bar">
    <h1>AI Battle</h1>
    <img src="https://raw.githubusercontent.com/AiGptCode/t/main/IMG_4113.png" alt="AI Battle Logo">
</div>
<div class="description">Welcome to our AI Battle! Ask a question and let our two AI models battle it out.</div>
<div class="main-section">
    <div style="display: flex; align-items: center;">
        <input type="text" id="question" placeholder="Ask a question...">
        <button onclick="askQuestion()">Ask</button>
    </div>
    <div>
        <label for="rounds">Select number of rounds:</label>
        <input type="number" id="rounds" name="rounds" min="1" max="20" value="10">
    </div>
    <div id="botResponses"></div>
</div>
<script>
    let conversationHistory = [];
    let currentBot = "user";
    const apiKeys = {
        "bot1": "A3J4yMeDGJ81Xpc2o5S4GGNKJCoA2NxzILXD3gbZAx7fTXeG",
        "bot2": "Aa0b4iHddGVZGMyRw2zurVVGPJhU2q2V1rHBO5dVAkUHconw"
    };

    const modelSettings = {
        "bot1": {
            "model": "accounts/fireworks/models/qwen2-72b-instruct",
            "temperature": 1.3,
            "max_tokens": 1024,
            "top_p": 0.9,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.6
        },
        "bot2": {
            "model": "accounts/fireworks/models/llama-v3-70b-instruct",
            "temperature": 1.3,
            "max_tokens": 1024,
            "top_p": 0.9,
            "frequency_penalty": 0.0,
            "presence_penalty": 0.6
        }
    };

    function generateBot1Prompt(conversation) {
        var systemMessage = "You are a highly intelligent assistant named qwen2. You are engaged in a discussion with another assistant named llama3. Your goal is to provide the most accurate, insightful, and informative responses. You should also address the points made by llama3 in your response and finally answer questions exactly same as user language,ask question.";
        return [{"role": "system", "content": systemMessage}].concat(conversation);
    }

    function generateBot2Prompt(conversation) {
        var systemMessage = "You are a critical thinker assistant named llama3. You are engaged in a discussion with another assistant named qwen2. Your goal is to provide thoughtful, well-reasoned, and informative responses. You should also address the points made by qwen2 in your response and finally answer questions exactly same as user language ,ask question.";
        return [{"role": "system", "content": systemMessage}].concat(conversation);
    }

    async function getAssistantResponse(bot, messages) {
        var url = "https://api.fireworks.ai/inference/v1/chat/completions";
        var payload = {
            "model": modelSettings[bot].model,
            "messages": messages,
            "temperature": modelSettings[bot].temperature,        "max_tokens": modelSettings[bot].max_tokens,
        "top_p": modelSettings[bot].top_p,
        "frequency_penalty": modelSettings[bot].frequency_penalty,
        "presence_penalty": modelSettings[bot].presence_penalty
    };
    var headers = {
        "Authorization": `Bearer ${apiKeys[bot]}`,
        "Content-Type": "application/json"
    };
    try {
        var response = await fetch(url, {
            method: 'POST',
            headers: headers,
            body: JSON.stringify(payload)
        });
        var data = await response.json();
        return data.choices[0].message.content;
    } catch (error) {
        console.error(error);
        return "An error occurred while fetching the response.";
    }
}

function textToSpeech(text, lang) {
    var utterance = new SpeechSynthesisUtterance();
    utterance.text = text;
    utterance.lang = lang;
    speechSynthesis.speak(utterance);
}

async function askQuestion() {
    var question = document.getElementById('question').value;
    conversationHistory.push({"role": "user", "content": question});

    var prompt = generateBot1Prompt(conversationHistory);
    var bot1Response = await getAssistantResponse("bot1", prompt);
    conversationHistory.push({"role": "assistant", "content": bot1Response});
    document.getElementById('botResponses').innerHTML += `<div class="bot-response bot1-response"><p>${bot1Response}</p></div>`;
    textToSpeech(bot1Response, 'en');

    // Bot 2 responds to Bot 1's last response
    prompt = generateBot2Prompt(conversationHistory);
    var bot2Response = await getAssistantResponse("bot2", prompt);
    conversationHistory.push({"role": "assistant", "content": bot2Response});
    document.getElementById('botResponses').innerHTML += `<div class="bot-response bot2-response"><p>${bot2Response}</p></div>`;
    textToSpeech(bot2Response, 'en');
    
    // Continue the conversation without user input
    continueConversation();
}

async function continueConversation() {
    var prompt = generateBot1Prompt(conversationHistory);
    var bot1Response = await getAssistantResponse("bot1", prompt);
    conversationHistory.push({"role": "assistant", "content": bot1Response});
    document.getElementById('botResponses').innerHTML += `<div class="bot-response bot1-response"><p>${bot1Response}</p></div>`;
    textToSpeech(bot1Response, 'en');

    // Bot 2 responds to Bot 1's last response
    prompt = generateBot2Prompt(conversationHistory);
    var bot2Response = await getAssistantResponse("bot2", prompt);
    conversationHistory.push({"role": "assistant", "content": bot2Response});
    document.getElementById('botResponses').innerHTML += `<div class="bot-response bot2-response"><p>${bot2Response}</p></div>`;
    textToSpeech(bot2Response, 'en');

    // Continue the conversation recursively
    continueConversation();
}
</script>
</body>
</html>
